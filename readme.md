# Система учета автомойки и детейлинга

Версия 5.3 - Ручная синхронизация с GitHub и управление классификацией расходов

## Основные изменения в версии 5.3

### 1. Убрана автоматическая синхронизация с GitHub
- **Проблема**: Автоматическая синхронизация работала с ошибками и могла вызывать конфликты данных
- **Решение**: Оставлена только ручная синхронизация через явные кнопки
- **Преимущества**: Больше контроля над процессом, меньше неожиданных ошибок

### 2. Добавлено управление классификацией расходов
- **Новая функция**: Возможность ручного изменения категорий расходов для финансовой аналитики
- **Визуализация**: Показывает, как система автоматически определила категорию расходов
- **Гибкость**: Сохранение ручных настроек для каждой операции

### 3. Сохранен весь существующий функционал
- Расчет прибыли по направлениям (детейлинг, посты 1-2, посты 3-5)
- Взаимные расчеты между партнерами
- Расширенная аналитика и отчетность
- Резервный фонд
- Экспорт в Excel и создание отчетов

## Как использовать новую систему классификации расходов

### Автоматическая классификация
Система автоматически определяет категории расходов на основе ключевых слов в описании:

- **Себестоимость (COGS)**: химия, материалы, оборудование, запчасти
- **Прямые затраты**: зарплата, оператор, мойщик, премия
- **Косвенные затраты**: реклама, маркетинг, банковские услуги
- **Постоянные затраты**: аренда, коммунальные услуги, лизинг
- **Переменные затраты**: транспорт, командировки, прочие расходы

### Ручное изменение категорий
1. Перейдите во вкладку "Операции"
2. Найдите таблицу "Расходы с автоматической классификацией"
3. Нажмите кнопку "Изменить" для нужной операции
4. Выберите нужную категорию из выпадающего списка
5. Сохраните изменения

Ручные настройки имеют приоритет над автоматическими и сохраняются в localStorage.

## Синхронизация с GitHub

### Настройка
1. Перейдите во вкладку "Настройки"
2. Заполните поля GitHub:
   - Personal Access Token (с правами repo)
   - Владелец репозитория
   - Название репозитория
   - Ветка (по умолчанию: main)
3. Нажмите "Сохранить настройки"

### Использование
- **Загрузить из GitHub**: Загружает данные из репозитория
- **Сохранить в GitHub**: Сохраняет данные с проверкой конфликтов
- **Принудительно сохранить**: Перезаписывает данные без проверки

### Рекомендации
- Перед сохранением всегда загружайте актуальные данные
- Используйте принудительное сохранение только в случае конфликтов
- Регулярно создавайте резервные копии

## Структура данных

### Категории операций
- **Детейлинг**: Услуги детейлинга
- **Самообслуживание (1-2)**: Посты самообслуживания 1 и 2
- **Самообслуживание (3-5)**: Посты самообслуживания 3, 4 и 5
- **Резервный фонд**: Общие расходы

### Способы оплаты
- Карта Акбарсбанка (Султан)
- Яндекс на Сбер (Султан)
- Наличные (Чингиз)
- Перевод на карту Чингиза
- Карта Сбер (Султан) - самообслуживание
- Наличные (Чингиз) - самообслуживание
- Резервный фонд Чингиза

## Условия партнерства

- Чистая прибыль от Детейлинга и постов 1-2 делится пополам
- Чистая прибыль от постов 3-5 принадлежит только Султану
- Расходы учитываются при расчете взаимных обязательств
- Резервный фонд используется для общих расходов

## Расширенная аналитика

### Показатели рентабельности
- Общая рентабельность
- Валовая маржа
- Чистая маржа
- Оборачиваемость активов

### Структура затрат
- Себестоимость продаж (COGS)
- Прямые затраты
- Косвенные затраты
- Постоянные затраты
- Переменные затраты

### Сравнительный анализ
- Эффективность по направлениям
- Динамика прибыли
- Тренды рентабельности

## Резервное копирование

Рекомендуется регулярно создавать резервные копии данных:
1. Перейдите в "Настройки"
2. Нажмите "Создать резервную копию"
3. Сохраните файл в надежном месте

Для восстановления:
1. Нажмите "Восстановить из резервной копии"
2. Выберите файл с резервной копией

## Поддержка

При возникновении проблем:
1. Проверьте консоль браузера (F12) на наличие ошибок
2. Убедитесь, что данные сохраняются в localStorage
3. Проверьте настройки GitHub
4. Создайте резервную копию перед экспериментами

## Технические детали

- Данные хранятся в localStorage браузера
- Поддерживается экспорт в Excel (XLSX)
- Совместимость с современными браузерами
- Адаптивный дизайн для мобильных устройств

---
*Разработано для SK-Detailing*